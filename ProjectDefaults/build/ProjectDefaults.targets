<?xml version="1.0" encoding="utf-8"?>
<Project>
  <Target
      Name="ProjectDefaultsUpdateNuspec"
      BeforeTargets="GenerateNuspec"
      Condition="$(GeneratePackageOnBuild)"
    >
    <Error
       Text="No 'RepositoryUrl' defined."
       Condition="'$(RepositoryUrl)' == ''" />
    <PropertyGroup>
      <RepositoryUrlEx>$(RepositoryUrl.Replace('.git', ''))</RepositoryUrlEx>
      <PackageProjectUrl Condition="$(PackageProjectUrl) == ''">$(RepositoryUrlEx.Replace('.git', ''))</PackageProjectUrl>
      <ReleaseNotes>$(RepositoryUrlEx)/milestones?state=closed</ReleaseNotes>
      <PackageIconUrl>$(RepositoryUrlEx.Replace('https://github.com', '%(SourceLinkGitHubHost.ContentUrl)'))/master/src/icon.png</PackageIconUrl>
      <Authors>$(RepositoryUrlEx)/graphs/contributors</Authors>
    </PropertyGroup>
  </Target>
</Project>